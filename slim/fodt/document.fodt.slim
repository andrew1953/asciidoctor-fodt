|<?xml version="1.0" encoding="#{attr :encoding}"?>
office:document(
  office:version='1.2'
  office:mimetype='application/vnd.oasis.opendocument.text'
  xmlns:office='urn:oasis:names:tc:opendocument:xmlns:office:1.0'
  xmlns:style='urn:oasis:names:tc:opendocument:xmlns:style:1.0'
  xmlns:text='urn:oasis:names:tc:opendocument:xmlns:text:1.0'
  xmlns:table='urn:oasis:names:tc:opendocument:xmlns:table:1.0'
  xmlns:draw='urn:oasis:names:tc:opendocument:xmlns:drawing:1.0'
  xmlns:fo='urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0'
  xmlns:xlink='http://www.w3.org/1999/xlink'
  xmlns:dc='http://purl.org/dc/elements/1.1/'
  xmlns:meta='urn:oasis:names:tc:opendocument:xmlns:meta:1.0'
  xmlns:number='urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0'
  xmlns:svg='urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0'
  xmlns:chart='urn:oasis:names:tc:opendocument:xmlns:chart:1.0'
  xmlns:dr3d='urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0'
  xmlns:math='http://www.w3.org/1998/Math/MathML'
  xmlns:form='urn:oasis:names:tc:opendocument:xmlns:form:1.0'
  xmlns:script='urn:oasis:names:tc:opendocument:xmlns:script:1.0'
  xmlns:config='urn:oasis:names:tc:opendocument:xmlns:config:1.0'
  xmlns:ooo='http://openoffice.org/2004/office'
  xmlns:ooow='http://openoffice.org/2004/writer'
  xmlns:oooc='http://openoffice.org/2004/calc'
  xmlns:dom='http://www.w3.org/2001/xml-events'
  xmlns:xforms='http://www.w3.org/2002/xforms'
  xmlns:xsd='http://www.w3.org/2001/XMLSchema'
  xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'
  xmlns:rpt='http://openoffice.org/2005/report'
  xmlns:of='urn:oasis:names:tc:opendocument:xmlns:of:1.2'
  xmlns:xhtml='http://www.w3.org/1999/xhtml'
  xmlns:grddl='http://www.w3.org/2003/g/data-view#'
  xmlns:tableooo='http://openoffice.org/2009/table'
  xmlns:field='urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0'
  xmlns:formx='urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0'
  xmlns:css3t='http://www.w3.org/TR/css3-text/')
  office:meta
    dc:title=(doctitle sanitize: true)
    - [[:subject, :keywords], [:description, :description], [:creator, :author], [:language, :lang]].each do |(tag,key)|
      - if attr? key
        *{tag: %(dc:#{tag})} =(attr key)
    meta:creation-date=(dt = ::DateTime.parse((attr? :revdate) ? (attr :revdate) : (attr :docdate)).strftime '%Y-%m-%dT%H:%M:%S')
    dc:date=dt
    meta:initial-creator=(attr :author)
    meta:generator=%(Asciidoctor #{attr 'asciidoctor-version'})
    - [:author, :email, :version].each do |key|
      - if attr? key
        meta:user-defined meta:name=key =(attr key)
  office:settings
    config:config-item-set config:name="ooo:view-settings"
     config:config-item config:name="ViewAreaTop" config:type="int" 0
     config:config-item config:name="ViewAreaLeft" config:type="int" 0
     config:config-item config:name="ViewAreaWidth" config:type="int" 24007
     config:config-item config:name="ViewAreaHeight" config:type="int" 15155
     config:config-item config:name="ShowRedlineChanges" config:type="boolean" false
     config:config-item config:name="InBrowseMode" config:type="boolean" false
     config:config-item-map-indexed config:name="Views"
      config:config-item-map-entry
       config:config-item config:name="ViewId" config:type="string" view2
       config:config-item config:name="ViewLeft" config:type="int" 4703
       config:config-item config:name="ViewTop" config:type="int" 5320
       config:config-item config:name="VisibleLeft" config:type="int" 0
       config:config-item config:name="VisibleTop" config:type="int" 157
       config:config-item config:name="VisibleRight" config:type="int" 24005
       config:config-item config:name="VisibleBottom" config:type="int" 15311
       config:config-item config:name="ZoomType" config:type="short" 0
       config:config-item config:name="ViewLayoutColumns" config:type="short" 1
       config:config-item config:name="ViewLayoutBookMode" config:type="boolean" false
       config:config-item config:name="ZoomFactor" config:type="short" 110
       config:config-item config:name="IsSelectedFrame" config:type="boolean" false
    config:config-item-set config:name="ooo:configuration-settings" 
     config:config-item config:name="ChartAutoUpdate" config:type="boolean" true
     config:config-item config:name="IsLabelDocument" config:type="boolean" false
     config:config-item config:name="MathBaselineAlignment" config:type="boolean" false
     config:config-item config:name="Rsid" config:type="int" 1759907
     config:config-item config:name="OutlineLevelYieldsNumbering" config:type="boolean" false
     config:config-item config:name="PrintLeftPages" config:type="boolean" true
     config:config-item config:name="DoNotJustifyLinesWithManualBreak" config:type="boolean" false
     config:config-item config:name="ClippedPictures" config:type="boolean" false
     config:config-item config:name="AlignTabStopPosition" config:type="boolean" true
     config:config-item config:name="PrintTextPlaceholder" config:type="boolean" false
     config:config-item config:name="UseOldNumbering" config:type="boolean" false
     config:config-item config:name="CurrentDatabaseCommand" config:type="string"
     config:config-item config:name="ProtectForm" config:type="boolean" false
     config:config-item config:name="PrintBlackFonts" config:type="boolean" false
     config:config-item config:name="PrintProspectRTL" config:type="boolean" false
     config:config-item config:name="BackgroundParaOverDrawings" config:type="boolean" false
     config:config-item config:name="FloattableNomargins" config:type="boolean" false
     config:config-item config:name="SmallCapsPercentage66" config:type="boolean" true
     config:config-item config:name="PrintControls" config:type="boolean" true
     config:config-item config:name="EmbedSystemFonts" config:type="boolean" false
     config:config-item config:name="CharacterCompressionType" config:type="short" 0
     config:config-item config:name="PrintHiddenText" config:type="boolean" false
     config:config-item config:name="UseFormerTextWrapping" config:type="boolean" false
     config:config-item config:name="IsKernAsianPunctuation" config:type="boolean" false
     config:config-item config:name="PrintProspect" config:type="boolean" false
     config:config-item config:name="PrintEmptyPages" config:type="boolean" true
     config:config-item config:name="UnbreakableNumberings" config:type="boolean" false
     config:config-item config:name="UseFormerObjectPositioning" config:type="boolean" false
     config:config-item config:name="ConsiderTextWrapOnObjPos" config:type="boolean" false
     config:config-item config:name="TableRowKeep" config:type="boolean" false
     config:config-item config:name="PrintReversed" config:type="boolean" false
     config:config-item config:name="TabsRelativeToIndent" config:type="boolean" true
     config:config-item config:name="PrintRightPages" config:type="boolean" true
     config:config-item config:name="PrintPaperFromSetup" config:type="boolean" false
     config:config-item config:name="AddFrameOffsets" config:type="boolean" false
     config:config-item config:name="AddParaSpacingToTableCells" config:type="boolean" true
     config:config-item config:name="UpdateFromTemplate" config:type="boolean" true
     config:config-item config:name="AddExternalLeading" config:type="boolean" true
     config:config-item config:name="PrintSingleJobs" config:type="boolean" false
     config:config-item config:name="PrinterIndependentLayout" config:type="string" high-resolution
     config:config-item config:name="RsidRoot" config:type="int" 1719347
     config:config-item config:name="LinkUpdateMode" config:type="short" 1
     config:config-item config:name="PrintAnnotationMode" config:type="short" 0
     config:config-item config:name="TabOverMargin" config:type="boolean" false
     config:config-item config:name="UseOldPrinterMetrics" config:type="boolean" false
     config:config-item config:name="RedlineProtectionKey" config:type="base64Binary"
     config:config-item config:name="IgnoreFirstLineIndentInNumbering" config:type="boolean" false
     config:config-item config:name="CollapseEmptyCellPara" config:type="boolean" true
     config:config-item config:name="PrinterName" config:type="string" Canon MX880 series @ gturnquist-mpro
     config:config-item config:name="EmbedFonts" config:type="boolean" false
     config:config-item config:name="InvertBorderSpacing" config:type="boolean" false
     config:config-item config:name="PrintPageBackground" config:type="boolean" true
     config:config-item config:name="DoNotCaptureDrawObjsOnPage" config:type="boolean" false
     config:config-item config:name="TabOverflow" config:type="boolean" false
     config:config-item config:name="ApplyUserData" config:type="boolean" true
     config:config-item config:name="TabAtLeftIndentForParagraphsInList" config:type="boolean" false
     config:config-item config:name="UnxForceZeroExtLeading" config:type="boolean" false
     config:config-item config:name="SaveVersionOnClose" config:type="boolean" false
     config:config-item config:name="PrintFaxName" config:type="string"
     config:config-item config:name="StylesNoDefault" config:type="boolean" false
     config:config-item config:name="AddParaTableSpacing" config:type="boolean" true
     config:config-item config:name="PrintDrawings" config:type="boolean" true
     config:config-item config:name="LoadReadonly" config:type="boolean" false
     config:config-item config:name="PrintGraphics" config:type="boolean" true
     config:config-item config:name="FieldAutoUpdate" config:type="boolean" true
     config:config-item config:name="AllowPrintJobCancel" config:type="boolean" true
     config:config-item config:name="UseFormerLineSpacing" config:type="boolean" false
     config:config-item config:name="SaveGlobalDocumentLinks" config:type="boolean" false
     config:config-item config:name="CurrentDatabaseDataSource" config:type="string"
     config:config-item config:name="IgnoreTabsAndBlanksForLineCalculation" config:type="boolean" false
     config:config-item config:name="CurrentDatabaseCommandType" config:type="int" 0
     config:config-item config:name="DoNotResetParaAttrsForNumFont" config:type="boolean" false
     config:config-item config:name="ClipAsCharacterAnchoredWriterFlyFrames" config:type="boolean" false
     config:config-item config:name="PrintTables" config:type="boolean" true
     config:config-item config:name="AddParaTableSpacingAtStart" config:type="boolean" true
  office:scripts
    office:script script:language="ooo:Basic"
     ooo:libraries xmlns:ooo="http://openoffice.org/2004/office" xmlns:xlink="http://www.w3.org/1999/xlink"
    office:event-listeners
      - if attr? :toc
        script:event-listener script-language='ooo:script' script:event-name='dom:load' xlink:href='.uno:UpdateAllIndexes'     
  include _styles.fodt

  office:body
    office:text text:use-soft-page-breaks='true'
      - segments = @header.title.rpartition(': ')
      - if segments.first.empty?
        text:p text:style-name='Title' =segments.last    
      - else
        text:p text:style-name='Title' =segments.first    
        text:p text:style-name='Subtitle' =segments.last

      text:p text:style-name='P7' =(attr :author)
      text:p text:style-name='P2'
      =content
